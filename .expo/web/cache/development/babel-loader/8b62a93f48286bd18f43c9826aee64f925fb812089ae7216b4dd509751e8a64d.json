{"ast":null,"code":"import NativeEventEmitter from \"../EventEmitter/NativeEventEmitter\";\nimport Platform from \"../Utilities/Platform\";\nimport NativeWebSocketModule from \"./NativeWebSocketModule\";\nimport base64 from 'base64-js';\nvar originalRCTWebSocketConnect = NativeWebSocketModule.connect;\nvar originalRCTWebSocketSend = NativeWebSocketModule.send;\nvar originalRCTWebSocketSendBinary = NativeWebSocketModule.sendBinary;\nvar originalRCTWebSocketClose = NativeWebSocketModule.close;\nvar eventEmitter;\nvar subscriptions;\nvar closeCallback;\nvar sendCallback;\nvar connectCallback;\nvar onOpenCallback;\nvar onMessageCallback;\nvar onErrorCallback;\nvar onCloseCallback;\nvar _isInterceptorEnabled = false;\nvar WebSocketInterceptor = {\n  setCloseCallback: function setCloseCallback(callback) {\n    closeCallback = callback;\n  },\n  setSendCallback: function setSendCallback(callback) {\n    sendCallback = callback;\n  },\n  setConnectCallback: function setConnectCallback(callback) {\n    connectCallback = callback;\n  },\n  setOnOpenCallback: function setOnOpenCallback(callback) {\n    onOpenCallback = callback;\n  },\n  setOnMessageCallback: function setOnMessageCallback(callback) {\n    onMessageCallback = callback;\n  },\n  setOnErrorCallback: function setOnErrorCallback(callback) {\n    onErrorCallback = callback;\n  },\n  setOnCloseCallback: function setOnCloseCallback(callback) {\n    onCloseCallback = callback;\n  },\n  isInterceptorEnabled: function isInterceptorEnabled() {\n    return _isInterceptorEnabled;\n  },\n  _unregisterEvents: function _unregisterEvents() {\n    subscriptions.forEach(function (e) {\n      return e.remove();\n    });\n    subscriptions = [];\n  },\n  _registerEvents: function _registerEvents() {\n    subscriptions = [eventEmitter.addListener('websocketMessage', function (ev) {\n      if (onMessageCallback) {\n        onMessageCallback(ev.id, ev.type === 'binary' ? WebSocketInterceptor._arrayBufferToString(ev.data) : ev.data);\n      }\n    }), eventEmitter.addListener('websocketOpen', function (ev) {\n      if (onOpenCallback) {\n        onOpenCallback(ev.id);\n      }\n    }), eventEmitter.addListener('websocketClosed', function (ev) {\n      if (onCloseCallback) {\n        onCloseCallback(ev.id, {\n          code: ev.code,\n          reason: ev.reason\n        });\n      }\n    }), eventEmitter.addListener('websocketFailed', function (ev) {\n      if (onErrorCallback) {\n        onErrorCallback(ev.id, {\n          message: ev.message\n        });\n      }\n    })];\n  },\n  enableInterception: function enableInterception() {\n    if (_isInterceptorEnabled) {\n      return;\n    }\n    eventEmitter = new NativeEventEmitter(Platform.OS !== 'ios' ? null : NativeWebSocketModule);\n    WebSocketInterceptor._registerEvents();\n    NativeWebSocketModule.connect = function (url, protocols, options, socketId) {\n      if (connectCallback) {\n        connectCallback(url, protocols, options, socketId);\n      }\n      originalRCTWebSocketConnect.apply(this, arguments);\n    };\n    NativeWebSocketModule.send = function (data, socketId) {\n      if (sendCallback) {\n        sendCallback(data, socketId);\n      }\n      originalRCTWebSocketSend.apply(this, arguments);\n    };\n    NativeWebSocketModule.sendBinary = function (data, socketId) {\n      if (sendCallback) {\n        sendCallback(WebSocketInterceptor._arrayBufferToString(data), socketId);\n      }\n      originalRCTWebSocketSendBinary.apply(this, arguments);\n    };\n    NativeWebSocketModule.close = function () {\n      if (closeCallback) {\n        if (arguments.length === 3) {\n          closeCallback(arguments[0], arguments[1], arguments[2]);\n        } else {\n          closeCallback(null, null, arguments[0]);\n        }\n      }\n      originalRCTWebSocketClose.apply(this, arguments);\n    };\n    _isInterceptorEnabled = true;\n  },\n  _arrayBufferToString: function _arrayBufferToString(data) {\n    var value = base64.toByteArray(data).buffer;\n    if (value === undefined || value === null) {\n      return '(no value)';\n    }\n    if (typeof ArrayBuffer !== 'undefined' && typeof Uint8Array !== 'undefined' && value instanceof ArrayBuffer) {\n      return `ArrayBuffer {${String(Array.from(new Uint8Array(value)))}}`;\n    }\n    return value;\n  },\n  disableInterception: function disableInterception() {\n    if (!_isInterceptorEnabled) {\n      return;\n    }\n    _isInterceptorEnabled = false;\n    NativeWebSocketModule.send = originalRCTWebSocketSend;\n    NativeWebSocketModule.sendBinary = originalRCTWebSocketSendBinary;\n    NativeWebSocketModule.close = originalRCTWebSocketClose;\n    NativeWebSocketModule.connect = originalRCTWebSocketConnect;\n    connectCallback = null;\n    closeCallback = null;\n    sendCallback = null;\n    onOpenCallback = null;\n    onMessageCallback = null;\n    onCloseCallback = null;\n    onErrorCallback = null;\n    WebSocketInterceptor._unregisterEvents();\n  }\n};\nmodule.exports = WebSocketInterceptor;","map":{"version":3,"names":["NativeEventEmitter","Platform","NativeWebSocketModule","base64","originalRCTWebSocketConnect","connect","originalRCTWebSocketSend","send","originalRCTWebSocketSendBinary","sendBinary","originalRCTWebSocketClose","close","eventEmitter","subscriptions","closeCallback","sendCallback","connectCallback","onOpenCallback","onMessageCallback","onErrorCallback","onCloseCallback","isInterceptorEnabled","WebSocketInterceptor","setCloseCallback","callback","setSendCallback","setConnectCallback","setOnOpenCallback","setOnMessageCallback","setOnErrorCallback","setOnCloseCallback","_unregisterEvents","forEach","e","remove","_registerEvents","addListener","ev","id","type","_arrayBufferToString","data","code","reason","message","enableInterception","OS","url","protocols","options","socketId","apply","arguments","length","value","toByteArray","buffer","undefined","ArrayBuffer","Uint8Array","String","Array","from","disableInterception","module","exports"],"sources":["C:/Users/arzug/Documents/GitHub/travel-brew/node_modules/react-native/Libraries/WebSocket/WebSocketInterceptor.js"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n */\n\nimport NativeEventEmitter from '../EventEmitter/NativeEventEmitter';\nimport Platform from '../Utilities/Platform';\nimport NativeWebSocketModule from './NativeWebSocketModule';\nimport base64 from 'base64-js';\n\nconst originalRCTWebSocketConnect = NativeWebSocketModule.connect;\nconst originalRCTWebSocketSend = NativeWebSocketModule.send;\nconst originalRCTWebSocketSendBinary = NativeWebSocketModule.sendBinary;\nconst originalRCTWebSocketClose = NativeWebSocketModule.close;\n\nlet eventEmitter;\nlet subscriptions;\n\nlet closeCallback;\nlet sendCallback;\nlet connectCallback;\nlet onOpenCallback;\nlet onMessageCallback;\nlet onErrorCallback;\nlet onCloseCallback;\n\nlet isInterceptorEnabled = false;\n\n/**\n * A network interceptor which monkey-patches RCTWebSocketModule methods\n * to gather all websocket network requests/responses, in order to show\n * their information in the React Native inspector development tool.\n */\n\nconst WebSocketInterceptor = {\n  /**\n   * Invoked when RCTWebSocketModule.close(...) is called.\n   */\n  setCloseCallback(callback) {\n    closeCallback = callback;\n  },\n\n  /**\n   * Invoked when RCTWebSocketModule.send(...) or sendBinary(...) is called.\n   */\n  setSendCallback(callback) {\n    sendCallback = callback;\n  },\n\n  /**\n   * Invoked when RCTWebSocketModule.connect(...) is called.\n   */\n  setConnectCallback(callback) {\n    connectCallback = callback;\n  },\n\n  /**\n   * Invoked when event \"websocketOpen\" happens.\n   */\n  setOnOpenCallback(callback) {\n    onOpenCallback = callback;\n  },\n\n  /**\n   * Invoked when event \"websocketMessage\" happens.\n   */\n  setOnMessageCallback(callback) {\n    onMessageCallback = callback;\n  },\n\n  /**\n   * Invoked when event \"websocketFailed\" happens.\n   */\n  setOnErrorCallback(callback) {\n    onErrorCallback = callback;\n  },\n\n  /**\n   * Invoked when event \"websocketClosed\" happens.\n   */\n  setOnCloseCallback(callback) {\n    onCloseCallback = callback;\n  },\n\n  isInterceptorEnabled() {\n    return isInterceptorEnabled;\n  },\n\n  _unregisterEvents() {\n    subscriptions.forEach(e => e.remove());\n    subscriptions = [];\n  },\n\n  /**\n   * Add listeners to the RCTWebSocketModule events to intercept them.\n   */\n  _registerEvents() {\n    subscriptions = [\n      eventEmitter.addListener('websocketMessage', ev => {\n        if (onMessageCallback) {\n          onMessageCallback(\n            ev.id,\n            ev.type === 'binary'\n              ? WebSocketInterceptor._arrayBufferToString(ev.data)\n              : ev.data,\n          );\n        }\n      }),\n      eventEmitter.addListener('websocketOpen', ev => {\n        if (onOpenCallback) {\n          onOpenCallback(ev.id);\n        }\n      }),\n      eventEmitter.addListener('websocketClosed', ev => {\n        if (onCloseCallback) {\n          onCloseCallback(ev.id, {code: ev.code, reason: ev.reason});\n        }\n      }),\n      eventEmitter.addListener('websocketFailed', ev => {\n        if (onErrorCallback) {\n          onErrorCallback(ev.id, {message: ev.message});\n        }\n      }),\n    ];\n  },\n\n  enableInterception() {\n    if (isInterceptorEnabled) {\n      return;\n    }\n    eventEmitter = new NativeEventEmitter(\n      // T88715063: NativeEventEmitter only used this parameter on iOS. Now it uses it on all platforms, so this code was modified automatically to preserve its behavior\n      // If you want to use the native module on other platforms, please remove this condition and test its behavior\n      Platform.OS !== 'ios' ? null : NativeWebSocketModule,\n    );\n    WebSocketInterceptor._registerEvents();\n\n    // Override `connect` method for all RCTWebSocketModule requests\n    // to intercept the request url, protocols, options and socketId,\n    // then pass them through the `connectCallback`.\n    NativeWebSocketModule.connect = function (\n      url,\n      protocols,\n      options,\n      socketId,\n    ) {\n      if (connectCallback) {\n        connectCallback(url, protocols, options, socketId);\n      }\n      originalRCTWebSocketConnect.apply(this, arguments);\n    };\n\n    // Override `send` method for all RCTWebSocketModule requests to intercept\n    // the data sent, then pass them through the `sendCallback`.\n    NativeWebSocketModule.send = function (data, socketId) {\n      if (sendCallback) {\n        sendCallback(data, socketId);\n      }\n      originalRCTWebSocketSend.apply(this, arguments);\n    };\n\n    // Override `sendBinary` method for all RCTWebSocketModule requests to\n    // intercept the data sent, then pass them through the `sendCallback`.\n    NativeWebSocketModule.sendBinary = function (data, socketId) {\n      if (sendCallback) {\n        sendCallback(WebSocketInterceptor._arrayBufferToString(data), socketId);\n      }\n      originalRCTWebSocketSendBinary.apply(this, arguments);\n    };\n\n    // Override `close` method for all RCTWebSocketModule requests to intercept\n    // the close information, then pass them through the `closeCallback`.\n    NativeWebSocketModule.close = function () {\n      if (closeCallback) {\n        if (arguments.length === 3) {\n          closeCallback(arguments[0], arguments[1], arguments[2]);\n        } else {\n          closeCallback(null, null, arguments[0]);\n        }\n      }\n      originalRCTWebSocketClose.apply(this, arguments);\n    };\n\n    isInterceptorEnabled = true;\n  },\n\n  _arrayBufferToString(data) {\n    const value = base64.toByteArray(data).buffer;\n    if (value === undefined || value === null) {\n      return '(no value)';\n    }\n    if (\n      typeof ArrayBuffer !== 'undefined' &&\n      typeof Uint8Array !== 'undefined' &&\n      value instanceof ArrayBuffer\n    ) {\n      return `ArrayBuffer {${String(Array.from(new Uint8Array(value)))}}`;\n    }\n    return value;\n  },\n\n  // Unpatch RCTWebSocketModule methods and remove the callbacks.\n  disableInterception() {\n    if (!isInterceptorEnabled) {\n      return;\n    }\n    isInterceptorEnabled = false;\n    NativeWebSocketModule.send = originalRCTWebSocketSend;\n    NativeWebSocketModule.sendBinary = originalRCTWebSocketSendBinary;\n    NativeWebSocketModule.close = originalRCTWebSocketClose;\n    NativeWebSocketModule.connect = originalRCTWebSocketConnect;\n\n    connectCallback = null;\n    closeCallback = null;\n    sendCallback = null;\n    onOpenCallback = null;\n    onMessageCallback = null;\n    onCloseCallback = null;\n    onErrorCallback = null;\n\n    WebSocketInterceptor._unregisterEvents();\n  },\n};\n\nmodule.exports = WebSocketInterceptor;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}